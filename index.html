<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Park Assist Review</title>
    <!-- <meta http-equiv="refresh" content="10"> -->
    <!-- css -->
    <link rel="stylesheet" href="styles/index.css">
    <link rel="stylesheet" href="styles/mobile.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
</head>

<body>
    <center>
        <div class='semi-circle'>
            <img class="logo" src="http://parkassist.asia/images/logo.png" alt="Park Assist logo">
        </div>
    </center>
    <div class="top-content">
        <h1>RATE OUR SERVICES</h1>
        <center>
            <lottie-player class="top-lottie" src="lottie/rating.json" background="transparent" speed="1" loop autoplay>
            </lottie-player>
        </center>
        <h3>Good day, please select the service you would like to rate.</h3>

    </div>
    <div class="content">


        <div class="row" style="justify-content: center;">
            <!-- popup modal -->
            <div class="modal fade" id="reviewform" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header" style="justify-content: center;">
                            <h5 class="modal-title" id="exampleModalLabel">Service One</h5>
                        </div>
                        <div class="modal-body">
                            <!-- form -->
                            <form class="gform pure-form pure-form-stacked" method="POST"
                                data-email="abishekmas0708@gmail.com"
                                action="https://script.google.com/macros/s/AKfycbxeeduD8u6WxHUPp3j5dN__2mpDXFhn4oUBEdvxH_UcdqUJtodh8pTmt7byWBUFIqfc7g/exec">
                                <div class="form-elements">
                                    <center>Please rate our service</center>
                                    <div class="row">
                                        <p class="col btn" title="Very Poor" onclick="show('Very Poor - ⭐')">
                                            <lottie-player src="lottie/angry.json" background="transparent" speed="1"
                                                style="height:90%;" loop autoplay>
                                        </p>
                                        <p class="col btn" title="Poor" onclick="show('Poor - ⭐⭐')">
                                            <lottie-player src="lottie/bad.json" background="transparent" speed="1"
                                                style="height:72%;" loop autoplay>
                                        </p>
                                        <p class="col btn" title="Average" onclick="show('Average - ⭐⭐⭐')">
                                            <lottie-player src="lottie/ok.json" background="transparent" speed="1"
                                                style="height:70%;" loop autoplay>
                                        </p>
                                        <p class="col btn" title="Good" onclick="show('Good - ⭐⭐⭐⭐')">
                                            <lottie-player src="lottie/good.json" background="transparent" speed="1"
                                                style="height:93%;" loop autoplay>
                                        </p>
                                        <p class="col btn" title="Excellent" onclick="show('Excellent - ⭐⭐⭐⭐⭐')">
                                            <lottie-player src="lottie/awsome.json" background="transparent" speed="1"
                                                style="height:65%;" loop autoplay>
                                        </p>
                                    </div>

                                    <input id="servicetype" type="text" type="text" readonly value="" disabled
                                        name="Rated For" required placeholder="Rated For" style="display: none;">

                                    <input id="rateMsg" type="text" class="readonly" readonly value="" disabled
                                        name="Rating" required placeholder="Not Rated Yet!">

                                    <div class="mb-3">
                                        <label for="email" class="col-form-label">Email:</label>
                                        <input type="email" name="Email" required placeholder="abc@domine.com"
                                            class="form-control" id="email">
                                    </div>

                                    <div class="mb-3">
                                        <label for="message-text" class="col-form-label">Message:</label>
                                        <textarea class="form-control" name="Message"
                                            placeholder="What we need to improve?" id="message-text"></textarea>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-danger"
                                            data-bs-dismiss="modal">Close</button>
                                        <input id="button" class="btn btn-success" type="submit" value="Submit">
                                    </div>
                                </div>
                                <!-- Thankyou_message -->
                                <div class="thankyou_message" style="display:none;">
                                    <center>
                                        <div class="thanks" style="padding: 0; width: 15rem;">
                                            <lottie-player
                                                src="https://assets7.lottiefiles.com/packages/lf20_m3ixidnq.json"
                                                background="transparent" speed="1" loop autoplay>
                                            </lottie-player>
                                        </div>
                                        <p>Thank You,
                                            <br> Your Review submitted succesfully.
                                        </p>
                                        <button class="btn btn-success" onClick="window.location.reload();">Submit New</button>
                                    </center>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
            </div>

            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 1" title="Rate this Service" type="button">
                Services 1
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 2" title="Rate this Service" type="button">
                Services 2
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 3" title="Rate this Service" type="button">
                Services 3
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 4" title="Rate this Service" type="button">
                Services 4
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 5" title="Rate this Service" type="button">
                Services 5
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 6" title="Rate this Service" type="button">
                Services 6
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 7" title="Rate this Service" type="button">
                Services 7
            </p>
            <p class="col-md-6 col-lg-4  more-btn btn btn-light" data-bs-toggle="modal" data-bs-target="#reviewform"
                data-whatever="Services 8" title="Rate this Service" type="button">
                Services 8
            </p>
        </div>
    </div>

    <ul class="background">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script data-cfasync="false" type="text/javascript">
        function show(rate) {
            document.getElementById("rateMsg").value = rate;
        }
        (function () {
            function validEmail(email) {
                var re = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;
                return re.test(email);
            }

            function validateHuman(honeypot) {
                if (honeypot) {
                    console.log("Robot Detected!");
                    return true;
                } else {
                    console.log("Welcome Human!");
                }
            }

            function getFormData(form) {
                var elements = form.elements;

                var fields = Object.keys(elements).filter(function (k) {
                    return (elements[k].name !== "honeypot");
                }).map(function (k) {
                    if (elements[k].name !== undefined) {
                        return elements[k].name;
                    } else if (elements[k].length > 0) {
                        return elements[k].item(0).name;
                    }
                }).filter(function (item, pos, self) {
                    return self.indexOf(item) == pos && item;
                });

                var formData = {};
                fields.forEach(function (name) {
                    var element = elements[name];
                    formData[name] = element.value;
                    if (element.length) {
                        var data = [];
                        for (var i = 0; i < element.length; i++) {
                            var item = element.item(i);
                            if (item.checked || item.selected) {
                                data.push(item.value);
                            }
                        }
                        formData[name] = data.join(', ');
                    }
                });

                // add form-specific values into the data
                formData.formDataNameOrder = JSON.stringify(fields);
                formData.formGoogleSheetName = form.dataset.sheet || "Sheet1"; // default sheet name
                formData.formGoogleSendEmail = form.dataset.email || ""; // no email by default

                console.log(formData);
                return formData;
            }

            function handleFormSubmit(event) {
                event.preventDefault();
                var form = event.target;
                var data = getFormData(form);
                if (data.email && !validEmail(data.email)) {
                    var invalidEmail = form.querySelector(".email-invalid");
                    if (invalidEmail) {
                        invalidEmail.style.display = "block";
                        return false;
                    }
                } else {
                    disableAllButtons(form);
                    var url = form.action;
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', url);
                    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                    xhr.onreadystatechange = function () {
                        console.log(xhr.status, xhr.statusText);
                        console.log(xhr.responseText);
                        var formElements = form.querySelector(".form-elements")
                        if (formElements) {
                            formElements.style.display = "none"; // hide form
                        }
                        var thankYouMessage = form.querySelector(".thankyou_message");
                        if (thankYouMessage) {
                            thankYouMessage.style.display = "block";
                        }
                        return;
                    };
                    var encoded = Object.keys(data).map(function (k) {
                        return encodeURIComponent(k) + "=" + encodeURIComponent(data[k]);
                    }).join('&');
                    xhr.send(encoded);
                }
            }

            function loaded() {
                console.log("Contact form submission handler loaded successfully.");
                var forms = document.querySelectorAll("form.gform");
                for (var i = 0; i < forms.length; i++) {
                    forms[i].addEventListener("submit", handleFormSubmit, false);
                }
            };
            document.addEventListener("DOMContentLoaded", loaded, false);

            function disableAllButtons(form) {
                var buttons = form.querySelectorAll("#button");
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].disabled = true;
                }
            }
        })();
    </script>
    <script>
        $('#reviewform').on('show.bs.modal', function (event) {
            var button = $(event.relatedTarget) // Button that triggered the modal
            var recipient = button.data('whatever') // Extract info from data-* attributes
            var modal = $(this)
            modal.find('.modal-title').text(recipient)
            modal.find('#servicetype').val(recipient)
        })
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous">
    </script>
    <script defer src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"
        integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc" crossorigin="anonymous">
    </script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
</body>

</html>